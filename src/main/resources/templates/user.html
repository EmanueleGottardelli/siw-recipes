<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>SiwRecipes - Dettagli Utente</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

	<div th:replace="fragments/navbar :: navbar"></div>

	<div class="container my-5">
		<div class="row">

			<!-- Details -->
			<div class="col-md-8">
				<h1 class="mb-3" th:text="${user.credentials.username}">username</h1>
				<p class="text-muted">
					<strong>Nome:</strong>
					<span th:text="${user.name}">Nome</span>
					<strong>Cognome:</strong>
					<span th:text="${user.surname}">Cognome</span>
					<strong>Email:</strong>
					<span th:text="${user.email}">Email</span>
					<strong>Stato:</strong>
					<span th:text="${user.state}">Active</span>
				</p>

				<a th:href="@{/user/{id}/edit(id=${user.id})}" class="btn btn-sm btn-warning me-2">Modifica il tuo profilo utente</a>

			</div>
		</div>

		<!-- Recipes -->
		<div th:if="${#lists.isEmpty(recipes)}" class="alert alert-warning text-center">
			Non hai pubblicato ancora nessuna ricetta!
		</div>
		<div th:each="recipe : ${user.recipes}" class="card mb-3">
			<div class="card-body">
				<p class="card-text" th:text="${recipe.title}">Titolo</p>
				<p class="fw-bold">Categoria: <span th:text="${recipe.category}">1</span></p>
				<p class="fw-bold">Difficoltà: <span th:text="${recipe.difficulty}">1</span>/5</p>
				<p class="fw-bold">Tempo di preparazione: <span th:text="${recipe.prepTime}">1</span></p>

				<div class="mt-3">
					<!-- Solo l'autore può modificare -->
					<a th:if="${userDetails != null and recipe.author.credentials.username == userDetails.username}"
						th:href="@{/recipe/{id}/edit(id=${recipe.id})}" class="btn btn-sm btn-warning me-2">Modifica</a>

					<!-- L'autore puo eliminare -->
					<a th:if="${userDetails != null and recipe.author.credentials.username == userDetails.username}"
						th:href="@{/recipe/{id}/deleteRecipe(id=${recipe.id})}"
						class="btn btn-sm btn-danger">Elimina</a>
				</div>
			</div>
		</div>

		<div class="mt-3 text-center">
			<a th:if="${globalUser != null}" th:href="@{/formNewRecipe}" class="btn btn-sm btn-warning me-2">Aggiungi
				una ricetta</a>
		</div>

		<div class="mt-3 text-center">
			<!-- Button back -->
			<a th:href="@{/}" class="btn btn-primary mt-3 text-center">Torna alla Homepage</a>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>